{% extends 'base.html' %}
{% block title %}Home - Exchange Items{% endblock %}
{% block content %}
	<div class="d-flex justify-content-between align-items-center mb-3">
		<h1 class="h4 mb-0">Items</h1>
		{% if user %}
			<a class="btn btn-primary" href="{{ url_for('create_item') }}">Add Item</a>
		{% else %}
			<a class="btn btn-outline-primary" href="{{ url_for('login') }}">Login to add</a>
		{% endif %}
	</div>
	<div class="row g-3">
		{% for item in items %}
			<div class="col-12 col-md-6 col-lg-4">
				<div class="card h-100">
					{% if item.image_filename %}
						<img src="{{ url_for('uploaded_file', filename=item.image_filename) }}" class="card-img-top" alt="{{ item.name }}" />
					{% endif %}
					<div class="card-body d-flex flex-column">
						<h5 class="card-title"><a href="{{ url_for('item_detail', item_id=item.id) }}">{{ item.name }}</a></h5>
						<p class="card-text mb-1"><strong>Wants:</strong> {{ item.expected_item }}</p>
						<p class="text-muted mb-2">{{ item.category }} • {{ item.location }}</p>
						<div class="mt-auto d-flex gap-2">
							<a class="btn btn-sm btn-outline-secondary" href="{{ url_for('item_detail', item_id=item.id) }}">Details</a>
							{% if user and user.id != item.owner_id %}
								<form method="post" action="{{ url_for('toggle_favourite', item_id=item.id) }}">
									<button type="submit" class="btn btn-sm btn-outline-primary">❤ Favourite</button>
								</form>
							{% endif %}
						</div>
					</div>
				</div>
			</div>
		{% else %}
			<p>No items yet.</p>
		{% endfor %}
	</div>
{% endblock %}

